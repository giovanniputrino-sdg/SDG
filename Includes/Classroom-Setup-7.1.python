{"version":"NotebookV1","origId":779539500128792,"name":"Classroom-Setup-7.1","language":"python","commands":[{"version":"CommandV1","origId":779539500128793,"guid":"d27a2968-a0c5-442a-86cc-c61a2e085800","subtype":"command","commandType":"auto","position":2.0,"command":"%run ./_utility-methods $lesson=\"7.1\"","commandVersion":1,"state":"finished","results":{"type":"raw","data":"","arguments":{},"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"02e86246-5a77-43dc-a36d-44b49ef663c8"},{"version":"CommandV1","origId":779539500128794,"guid":"d524a0e1-7142-4013-a10b-2915955b467b","subtype":"command","commandType":"auto","position":3.0,"command":"%run ./mount-datasets","commandVersion":1,"state":"finished","results":{"type":"raw","data":"","arguments":{},"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"892f10e3-29bc-4c08-94eb-ebc1d6bedf00"},{"version":"CommandV1","origId":779539500128795,"guid":"f2f1cf37-08e4-49f5-b473-0cce840b6457","subtype":"command","commandType":"auto","position":4.0,"command":"class DataFactory:\n    def __init__(self):\n        self.source = f\"{DA.paths.data_source}/tracker/streaming/\"\n        self.userdir = DA.paths.data_landing_location\n        self.curr_mo = 1\n    \n    def load(self, continuous=False):\n        if self.curr_mo > 12:\n            print(\"Data source exhausted\\n\")\n        elif continuous == True:\n            while self.curr_mo <= 12:\n                curr_file = f\"{self.curr_mo:02}.json\"\n                target_dir = f\"{self.userdir}/{curr_file}\"\n                print(f\"Loading the file {curr_file} to the {target_dir}\")\n                dbutils.fs.cp(f\"{self.source}/{curr_file}\", target_dir)\n                self.curr_mo += 1\n        else:\n            curr_file = f\"{str(self.curr_mo).zfill(2)}.json\"\n            target_dir = f\"{self.userdir}/{curr_file}\"\n            print(f\"Loading the file {curr_file} to the {target_dir}\")\n\n            dbutils.fs.cp(f\"{self.source}/{curr_file}\", target_dir)\n            self.curr_mo += 1\n","commandVersion":1,"state":"finished","results":{"type":"raw","data":"","arguments":{},"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"60132fb7-42e8-434d-9389-6547c2c91b57"},{"version":"CommandV1","origId":779539500128796,"guid":"db1c1dab-6384-4989-983c-e753ca73d478","subtype":"command","commandType":"auto","position":5.0,"command":"DA.init()\nDA.paths.checkpoints = f\"{DA.paths.working_dir}/_checkpoints\"    \nDA.paths.data_source = \"/mnt/training/healthcare\"\nDA.paths.data_landing_location    = f\"{DA.paths.working_dir}/source/tracker\"\n\n# bronzePath             = f\"{DA.paths.wokring_dir}/bronze\"\n# recordingsParsedPath   = f\"{DA.paths.wokring_dir}/silver/recordings_parsed\"\n# recordingsEnrichedPath = f\"{DA.paths.wokring_dir}/silver/recordings_enriched\"\n# dailyAvgPath           = f\"{DA.paths.wokring_dir}/gold/dailyAvg\"\n\n# checkpointPath               = f\"{DA.paths.wokring_dir}/checkpoints\"\n#bronzeCheckpoint             = f\"{DA.paths.checkpoints}/bronze\"\n# recordingsParsedCheckpoint   = f\"{DA.paths.checkpoints}/recordings_parsed\"\n# recordingsEnrichedCheckpoint = f\"{DA.paths.checkpoints}/recordings_enriched\"\n# dailyAvgCheckpoint           = f\"{DA.paths.checkpoints}/dailyAvgPath\"\n\nDA.data_factory = DataFactory()\nDA.conclude_setup()\n\nsqlContext.setConf(\"spark.sql.shuffle.partitions\", spark.sparkContext.defaultParallelism)\n","commandVersion":1,"state":"finished","results":{"type":"raw","data":"","arguments":{},"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"362ebd97-fc1a-48e4-babb-97d3e78b9fd0"}],"dashboards":[],"guid":"4a9212de-b6e6-4c12-bc01-f207e5427b6b","globalVars":{},"iPythonMetadata":null,"inputWidgets":{},"notebookMetadata":{"pythonIndentUnit":2},"reposExportFormat":"SOURCE"}