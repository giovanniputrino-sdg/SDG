{"version":"NotebookV1","origId":779539500128695,"name":"Classroom-Setup-11.2L","language":"python","commands":[{"version":"CommandV1","origId":779539500128696,"guid":"363bbdda-9563-44c6-86ee-d7460ea562d9","subtype":"command","commandType":"auto","position":2.0,"command":"%run ./_utility-methods $lesson=\"acls_lab\"","commandVersion":1,"state":"finished","results":{"type":"raw","data":"","arguments":{},"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"6faea776-914f-4e63-98d0-6f421ee8d1fc"},{"version":"CommandV1","origId":779539500128697,"guid":"fc6db2e3-f324-4d98-9439-b03e3f022319","subtype":"command","commandType":"auto","position":3.0,"command":"def print_sql(rows, sql):\n    displayHTML(f\"\"\"<body><textarea style=\"width:100%\" rows={rows}> \\n{sql.strip()}</textarea></body>\"\"\")","commandVersion":1,"state":"finished","results":{"type":"raw","data":"","arguments":{},"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"587aa661-fafc-4aa7-bde8-6c65ae618df5"},{"version":"CommandV1","origId":779539500128698,"guid":"9f86fc87-a07e-4961-9138-5f677bb9c777","subtype":"command","commandType":"auto","position":4.0,"command":"def _generate_query():\n    import re\n    import random\n\n    print_sql(23, f\"\"\"\nCREATE DATABASE IF NOT EXISTS {DA.db_name}\nLOCATION '{DA.paths.user_db}';\n\nUSE {DA.db_name};\n    \nCREATE TABLE beans \n(name STRING, color STRING, grams FLOAT, delicious BOOLEAN); \n\nINSERT INTO beans\nVALUES ('black', 'black', {random.uniform(0, 5000):.2f}, {random.choice([\"true\", \"false\"])}),\n       ('lentils', 'brown', {random.uniform(0, 5000):.2f}, {random.choice([\"true\", \"false\"])}),\n       ('jelly', 'rainbow', {random.uniform(0, 5000):.2f}, {random.choice([\"true\", \"false\"])}),\n       ('pinto', 'brown', {random.uniform(0, 5000):.2f}, {random.choice([\"true\", \"false\"])}),\n       ('green', 'green', {random.uniform(0, 5000):.2f}, {random.choice([\"true\", \"false\"])}),\n       ('beanbag chair', 'white', {random.uniform(0, 5000):.2f}, {random.choice([\"true\", \"false\"])}),\n       ('lentils', 'green', {random.uniform(0, 5000):.2f}, {random.choice([\"true\", \"false\"])}),\n       ('kidney', 'red', {random.uniform(0, 5000):.2f}, {random.choice([\"true\", \"false\"])}),\n       ('castor', 'brown', {random.uniform(0, 5000):.2f}, {random.choice([\"true\", \"false\"])});\n\nCREATE VIEW tasty_beans\nAS SELECT * FROM beans WHERE delicious = true;\n    \"\"\")\n\nDA.generate_query = _generate_query","commandVersion":1,"state":"finished","results":{"type":"raw","data":"","arguments":{},"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"71ee7d3f-71de-4faf-b229-84ce88c385df"},{"version":"CommandV1","origId":779539500128699,"guid":"14a15272-ab7a-4212-9525-110cca168470","subtype":"command","commandType":"auto","position":5.0,"command":"def _generate_confirmation_query(username):\n    import re\n    clean_username = re.sub(\"[^a-zA-Z0-9]\", \"_\", username)\n    database = DA.db_name.replace(DA.clean_username, clean_username)\n    \n    print_sql(11, f\"\"\"\nUSE {database};\n\nSELECT * FROM beans;\nSELECT * FROM tasty_beans;\nSELECT * FROM beans MINUS SELECT * FROM tasty_beans;\n\nUPDATE beans\nSET color = 'pink'\nWHERE name = 'black'\n\"\"\")\n\nDA.generate_confirmation_query = _generate_confirmation_query","commandVersion":1,"state":"finished","results":{"type":"raw","data":"","arguments":{},"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"3d59b408-bf4e-41b7-a584-45b8406f060b"},{"version":"CommandV1","origId":779539500128700,"guid":"9b392531-75a8-4327-838e-3c7537255b18","subtype":"command","commandType":"auto","position":6.0,"command":"def _generate_union_query():\n    print_sql(6, f\"\"\"\nUSE {DA.db_name};\n\nSELECT * FROM beans\nUNION ALL TABLE beans;\"\"\")\n\nDA.generate_union_query = _generate_union_query","commandVersion":1,"state":"finished","results":{"type":"raw","data":"","arguments":{},"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"ceba0ae2-5276-4728-9940-d5e70b2a1b91"},{"version":"CommandV1","origId":779539500128701,"guid":"76ea8d94-b751-4ddd-8684-8861ddcc0533","subtype":"command","commandType":"auto","position":7.0,"command":"def _generate_derivative_view():\n    print_sql(7, f\"\"\"\nUSE {DA.db_name};\n\nCREATE VIEW our_beans \nAS SELECT * FROM beans\nUNION ALL TABLE beans;\n\"\"\")\n\nDA.generate_derivative_view = _generate_derivative_view","commandVersion":1,"state":"finished","results":{"type":"raw","data":"","arguments":{},"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"1d31acc7-ceba-4465-bc0b-71d9a2684325"},{"version":"CommandV1","origId":779539500128702,"guid":"d000885b-fcf4-4aa2-b6c3-0b3365e5a6b5","subtype":"command","commandType":"auto","position":8.0,"command":"def _generate_partner_view(username):\n    import re\n    clean_username = re.sub(\"[^a-zA-Z0-9]\", \"_\", username)\n    database = DA.db_name.replace(DA.clean_username, clean_username)\n    \n    print_sql(7, f\"\"\"\nUSE {database};\n\nSELECT name, color, delicious, sum(grams)\nFROM our_beans\nGROUP BY name, color, delicious;\"\"\")\n\nDA.generate_partner_view = _generate_partner_view","commandVersion":1,"state":"finished","results":{"type":"raw","data":"","arguments":{},"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"e0eee804-22fe-4dfe-af05-b89cb3ed8e09"},{"version":"CommandV1","origId":779539500128703,"guid":"5fcdf5ef-535c-431c-a8e0-2c07eb7d7e1b","subtype":"command","commandType":"auto","position":9.0,"command":"def _generate_delete_query(username):\n    import re\n    clean_username = re.sub(\"[^a-zA-Z0-9]\", \"_\", username)\n    database = DA.db_name.replace(DA.clean_username, clean_username)\n    \n    print_sql(5, f\"\"\"\nUSE {database};\n\nDELETE FROM beans\n    \"\"\")\n\nDA.generate_delete_query = _generate_delete_query","commandVersion":1,"state":"finished","results":{"type":"raw","data":"","arguments":{},"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"9c535b02-7356-4f8b-a8bf-6dbf28647a19"},{"version":"CommandV1","origId":779539500128704,"guid":"16b8fa94-babe-4eaa-ae87-2379d031ad86","subtype":"command","commandType":"auto","position":10.0,"command":"DA.cleanup()\nDA.init(create_db=False)\nDA.conclude_setup()\n","commandVersion":1,"state":"finished","results":{"type":"raw","data":"","arguments":{},"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"8cce8851-c5cc-44a9-a95d-f07d368acbcd"}],"dashboards":[],"guid":"6f5301e7-3084-4d60-aac9-9b8da2df4347","globalVars":{},"iPythonMetadata":null,"inputWidgets":{},"notebookMetadata":{"pythonIndentUnit":2},"reposExportFormat":"SOURCE"}