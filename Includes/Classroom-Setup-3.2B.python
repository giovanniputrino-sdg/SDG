{"version":"NotebookV1","origId":779539500128705,"name":"Classroom-Setup-3.2B","language":"python","commands":[{"version":"CommandV1","origId":779539500128706,"guid":"b0776d5b-3108-422c-a612-4b866d01cc65","subtype":"command","commandType":"auto","position":2.0,"command":"%run ./_utility-methods $lesson=\"3.2\"","commandVersion":1,"state":"finished","results":{"type":"raw","data":"","arguments":{},"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"fea05564-0aa6-4fc2-9e23-5f143a315072"},{"version":"CommandV1","origId":779539500128707,"guid":"04506e43-d38b-4076-95f1-864a9cfa8f5e","subtype":"command","commandType":"auto","position":3.0,"command":"# We want the state from the previous lesson\n# DA.cleanup() # DO NOT EXECUTE\n\ntags = sc._jvm.scala.collection.JavaConversions.mapAsJavaMap(dbutils.entry_point.getDbutils().notebook().getContext().tags())\nis_job = \"jobId\" in tags\nif is_job: print(\"Mocking global temp view\")\n\nDA.init(create_db=is_job)\n\nif is_job:\n    spark.sql(f\"\"\"USE {DA.db_name}\"\"\")\n    spark.sql(\"\"\"CREATE TABLE IF NOT EXISTS external_table USING CSV OPTIONS (path '${da.paths.working_dir}/flight_delays', header \"true\", mode \"FAILFAST\");\"\"\")\n    spark.sql(\"\"\"CREATE OR REPLACE GLOBAL TEMPORARY VIEW global_temp_view_dist_gt_1000 AS SELECT * FROM external_table WHERE distance > 1000;\"\"\")\n\nprint()\nDA.conclude_setup()\n","commandVersion":1,"state":"finished","results":{"type":"raw","data":"","arguments":{},"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"720b332a-c4ad-44b4-917d-421748418960"}],"dashboards":[],"guid":"293b27bd-de37-48fd-a412-1c5ebd81e62e","globalVars":{},"iPythonMetadata":null,"inputWidgets":{},"notebookMetadata":{"pythonIndentUnit":2},"reposExportFormat":"SOURCE"}