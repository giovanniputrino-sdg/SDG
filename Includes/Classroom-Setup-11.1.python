{"version":"NotebookV1","origId":779539500128625,"name":"Classroom-Setup-11.1","language":"python","commands":[{"version":"CommandV1","origId":779539500128626,"guid":"ffc15f60-5e4a-405b-84f7-0a315cb2747a","subtype":"command","commandType":"auto","position":2.0,"command":"%run ./_utility-methods $lesson=\"11.1\"","commandVersion":1,"state":"finished","results":{"type":"raw","data":"","arguments":{},"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"c4cb7780-345c-403c-9acb-54bd6a3bdc48"},{"version":"CommandV1","origId":779539500128627,"guid":"5c238ade-fb27-4cad-a64f-34b45d90d6c4","subtype":"command","commandType":"auto","position":3.0,"command":"def print_sql(rows, sql):\n    html = f\"\"\"<textarea style=\"width:100%\" rows=\"{rows}\"> \\n{sql.strip()}</textarea>\"\"\"\n    displayHTML(html)","commandVersion":1,"state":"finished","results":{"type":"raw","data":"","arguments":{},"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"e835ca9d-03d8-435d-9257-74880dd2e2e4"},{"version":"CommandV1","origId":779539500128628,"guid":"21bf2b92-136d-4fcf-95c4-c29a1a024d16","subtype":"command","commandType":"auto","position":4.0,"command":"def _generate_users_table():\n    print_sql(20, f\"\"\"\nCREATE DATABASE IF NOT EXISTS {DA.db_name}\nLOCATION '{DA.paths.user_db}';\n\nUSE {DA.db_name};\n\nCREATE TABLE users (id INT, name STRING, value DOUBLE, state STRING);\n\nINSERT INTO users\nVALUES (1, \"Yve\", 1.0, \"CA\"),\n       (2, \"Omar\", 2.5, \"NY\"),\n       (3, \"Elia\", 3.3, \"OH\"),\n       (4, \"Rebecca\", 4.7, \"TX\"),\n       (5, \"Ameena\", 5.3, \"CA\"),\n       (6, \"Ling\", 6.6, \"NY\"),\n       (7, \"Pedro\", 7.1, \"KY\");\n\nCREATE VIEW ny_users_vw\nAS SELECT * FROM users WHERE state = 'NY';\n\"\"\")\n    \nDA.generate_users_table = _generate_users_table","commandVersion":1,"state":"finished","results":{"type":"raw","data":"","arguments":{},"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"ad400d5d-659c-4925-8f8e-862da5801c9d"},{"version":"CommandV1","origId":779539500128629,"guid":"0ca43715-1152-43d0-9a0f-f770325f35bc","subtype":"command","commandType":"auto","position":5.0,"command":"def _generate_create_database_with_grants():\n    print_sql(7, f\"\"\"\nCREATE DATABASE {DA.db_name}_derivative;\n\nGRANT USAGE, READ_METADATA, CREATE, MODIFY, SELECT ON DATABASE `{DA.db_name}_derivative` TO `users`;\n\nSHOW GRANT ON DATABASE `{DA.db_name}_derivative`;\"\"\")    \n    \nDA.generate_create_database_with_grants = _generate_create_database_with_grants","commandVersion":1,"state":"finished","results":{"type":"raw","data":"","arguments":{},"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"12f15e28-7971-4ec5-be84-1222827cafa7"},{"version":"CommandV1","origId":779539500128630,"guid":"ad469f51-5f7e-4e3c-b50f-f90a9b1fb4d1","subtype":"command","commandType":"auto","position":6.0,"command":"DA.cleanup()\nDA.init(create_db=False)\nDA.conclude_setup()\n","commandVersion":1,"state":"finished","results":{"type":"raw","data":"","arguments":{},"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"ed2e3abf-62d7-453d-8e00-38a3c76f1496"}],"dashboards":[],"guid":"1d5cc4e3-2ebf-4a4f-a0dc-1554867c04bf","globalVars":{},"iPythonMetadata":null,"inputWidgets":{},"notebookMetadata":{"pythonIndentUnit":2},"reposExportFormat":"SOURCE"}