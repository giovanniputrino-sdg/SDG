{"version":"NotebookV1","origId":779539500130292,"name":"Classroom-Setup-7.1","language":"python","commands":[{"version":"CommandV1","origId":779539500130293,"guid":"2812f42f-eff9-4369-9ad0-daf03c4fe5a1","subtype":"command","commandType":"auto","position":2.0,"command":"%run ./_utility-methods $lesson=\"7.1\"","commandVersion":1,"state":"finished","results":{"type":"raw","data":"","arguments":{},"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"f82b5b65-ba0e-42c5-927f-1b029d89bf5d"},{"version":"CommandV1","origId":779539500130294,"guid":"d8f7ee29-0c69-4c09-823c-6c18d02db8b4","subtype":"command","commandType":"auto","position":3.0,"command":"%run ./mount-datasets","commandVersion":1,"state":"finished","results":{"type":"raw","data":"","arguments":{},"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"c6d10de8-b475-4893-aa40-0034144a140b"},{"version":"CommandV1","origId":779539500130295,"guid":"fa123bfc-fbf8-4687-9339-dec155a98e90","subtype":"command","commandType":"auto","position":4.0,"command":"class DataFactory:\n    def __init__(self):\n        self.source = f\"{DA.paths.data_source}/tracker/streaming/\"\n        self.userdir = DA.paths.data_landing_location\n        self.curr_mo = 1\n    \n    def load(self, continuous=False):\n        if self.curr_mo > 12:\n            print(\"Data source exhausted\\n\")\n        elif continuous == True:\n            while self.curr_mo <= 12:\n                curr_file = f\"{self.curr_mo:02}.json\"\n                target_dir = f\"{self.userdir}/{curr_file}\"\n                print(f\"Loading the file {curr_file} to the {target_dir}\")\n                dbutils.fs.cp(f\"{self.source}/{curr_file}\", target_dir)\n                self.curr_mo += 1\n        else:\n            curr_file = f\"{str(self.curr_mo).zfill(2)}.json\"\n            target_dir = f\"{self.userdir}/{curr_file}\"\n            print(f\"Loading the file {curr_file} to the {target_dir}\")\n\n            dbutils.fs.cp(f\"{self.source}/{curr_file}\", target_dir)\n            self.curr_mo += 1\n","commandVersion":1,"state":"finished","results":{"type":"raw","data":"","arguments":{},"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"958a90ad-8a02-440f-91a2-cca429969e4d"},{"version":"CommandV1","origId":779539500130296,"guid":"bf4ac054-8bc5-439c-9d59-61aa8d3fdeba","subtype":"command","commandType":"auto","position":5.0,"command":"DA.init()\nDA.paths.checkpoints = f\"{DA.paths.working_dir}/_checkpoints\"    \nDA.paths.data_source = \"/mnt/training/healthcare\"\nDA.paths.data_landing_location    = f\"{DA.paths.working_dir}/source/tracker\"\n\n# bronzePath             = f\"{DA.paths.wokring_dir}/bronze\"\n# recordingsParsedPath   = f\"{DA.paths.wokring_dir}/silver/recordings_parsed\"\n# recordingsEnrichedPath = f\"{DA.paths.wokring_dir}/silver/recordings_enriched\"\n# dailyAvgPath           = f\"{DA.paths.wokring_dir}/gold/dailyAvg\"\n\n# checkpointPath               = f\"{DA.paths.wokring_dir}/checkpoints\"\n#bronzeCheckpoint             = f\"{DA.paths.checkpoints}/bronze\"\n# recordingsParsedCheckpoint   = f\"{DA.paths.checkpoints}/recordings_parsed\"\n# recordingsEnrichedCheckpoint = f\"{DA.paths.checkpoints}/recordings_enriched\"\n# dailyAvgCheckpoint           = f\"{DA.paths.checkpoints}/dailyAvgPath\"\n\nDA.data_factory = DataFactory()\nDA.conclude_setup()\n\nsqlContext.setConf(\"spark.sql.shuffle.partitions\", spark.sparkContext.defaultParallelism)\n","commandVersion":1,"state":"finished","results":{"type":"raw","data":"","arguments":{},"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"0adea543-3e6f-43d4-8300-72da188c6f96"}],"dashboards":[],"guid":"75c008f9-eb1f-4179-ac93-68c0f6d46c7f","globalVars":{},"iPythonMetadata":null,"inputWidgets":{},"notebookMetadata":{"pythonIndentUnit":2},"reposExportFormat":"SOURCE"}