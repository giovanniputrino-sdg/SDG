{"version":"NotebookV1","origId":779539500130257,"name":"Classroom-Setup-11.2L","language":"python","commands":[{"version":"CommandV1","origId":779539500130258,"guid":"e1904c0d-ed9c-4652-aad6-de0cb2fb6332","subtype":"command","commandType":"auto","position":2.0,"command":"%run ./_utility-methods $lesson=\"acls_lab\"","commandVersion":1,"state":"finished","results":{"type":"raw","data":"","arguments":{},"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"dc0e366d-88a3-4c63-a548-b89432abef0a"},{"version":"CommandV1","origId":779539500130259,"guid":"1bd0d44b-a066-4a0a-804b-e92cfcc3c911","subtype":"command","commandType":"auto","position":3.0,"command":"def print_sql(rows, sql):\n    displayHTML(f\"\"\"<body><textarea style=\"width:100%\" rows={rows}> \\n{sql.strip()}</textarea></body>\"\"\")","commandVersion":1,"state":"finished","results":{"type":"raw","data":"","arguments":{},"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"72484f63-a4b5-4548-9419-0e83a1eee4d9"},{"version":"CommandV1","origId":779539500130260,"guid":"1ed8c7b5-22bb-4be3-ad25-778c67b4dce2","subtype":"command","commandType":"auto","position":4.0,"command":"def _generate_query():\n    import re\n    import random\n\n    print_sql(23, f\"\"\"\nCREATE DATABASE IF NOT EXISTS {DA.db_name}\nLOCATION '{DA.paths.user_db}';\n\nUSE {DA.db_name};\n    \nCREATE TABLE beans \n(name STRING, color STRING, grams FLOAT, delicious BOOLEAN); \n\nINSERT INTO beans\nVALUES ('black', 'black', {random.uniform(0, 5000):.2f}, {random.choice([\"true\", \"false\"])}),\n       ('lentils', 'brown', {random.uniform(0, 5000):.2f}, {random.choice([\"true\", \"false\"])}),\n       ('jelly', 'rainbow', {random.uniform(0, 5000):.2f}, {random.choice([\"true\", \"false\"])}),\n       ('pinto', 'brown', {random.uniform(0, 5000):.2f}, {random.choice([\"true\", \"false\"])}),\n       ('green', 'green', {random.uniform(0, 5000):.2f}, {random.choice([\"true\", \"false\"])}),\n       ('beanbag chair', 'white', {random.uniform(0, 5000):.2f}, {random.choice([\"true\", \"false\"])}),\n       ('lentils', 'green', {random.uniform(0, 5000):.2f}, {random.choice([\"true\", \"false\"])}),\n       ('kidney', 'red', {random.uniform(0, 5000):.2f}, {random.choice([\"true\", \"false\"])}),\n       ('castor', 'brown', {random.uniform(0, 5000):.2f}, {random.choice([\"true\", \"false\"])});\n\nCREATE VIEW tasty_beans\nAS SELECT * FROM beans WHERE delicious = true;\n    \"\"\")\n\nDA.generate_query = _generate_query","commandVersion":1,"state":"finished","results":{"type":"raw","data":"","arguments":{},"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"71458254-c224-4e2b-a0aa-87796fa0ecdd"},{"version":"CommandV1","origId":779539500130261,"guid":"1d3d587a-444f-42ea-b744-19e5e331e7ec","subtype":"command","commandType":"auto","position":5.0,"command":"def _generate_confirmation_query(username):\n    import re\n    clean_username = re.sub(\"[^a-zA-Z0-9]\", \"_\", username)\n    database = DA.db_name.replace(DA.clean_username, clean_username)\n    \n    print_sql(11, f\"\"\"\nUSE {database};\n\nSELECT * FROM beans;\nSELECT * FROM tasty_beans;\nSELECT * FROM beans MINUS SELECT * FROM tasty_beans;\n\nUPDATE beans\nSET color = 'pink'\nWHERE name = 'black'\n\"\"\")\n\nDA.generate_confirmation_query = _generate_confirmation_query","commandVersion":1,"state":"finished","results":{"type":"raw","data":"","arguments":{},"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"2819cf8e-456a-4761-8c93-f967baed1a5e"},{"version":"CommandV1","origId":779539500130262,"guid":"b5270306-1ec1-43b8-895d-cfc1faacd467","subtype":"command","commandType":"auto","position":6.0,"command":"def _generate_union_query():\n    print_sql(6, f\"\"\"\nUSE {DA.db_name};\n\nSELECT * FROM beans\nUNION ALL TABLE beans;\"\"\")\n\nDA.generate_union_query = _generate_union_query","commandVersion":1,"state":"finished","results":{"type":"raw","data":"","arguments":{},"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"c94be5ea-d330-4fd6-b024-8633cf075251"},{"version":"CommandV1","origId":779539500130263,"guid":"e0169a7b-6a67-4f0d-aa68-92c495b8acd7","subtype":"command","commandType":"auto","position":7.0,"command":"def _generate_derivative_view():\n    print_sql(7, f\"\"\"\nUSE {DA.db_name};\n\nCREATE VIEW our_beans \nAS SELECT * FROM beans\nUNION ALL TABLE beans;\n\"\"\")\n\nDA.generate_derivative_view = _generate_derivative_view","commandVersion":1,"state":"finished","results":{"type":"raw","data":"","arguments":{},"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"f51db063-69b5-4d8d-9c33-e560fbd1bced"},{"version":"CommandV1","origId":779539500130264,"guid":"b90235c5-dee4-4884-a4a6-8c40efd141b1","subtype":"command","commandType":"auto","position":8.0,"command":"def _generate_partner_view(username):\n    import re\n    clean_username = re.sub(\"[^a-zA-Z0-9]\", \"_\", username)\n    database = DA.db_name.replace(DA.clean_username, clean_username)\n    \n    print_sql(7, f\"\"\"\nUSE {database};\n\nSELECT name, color, delicious, sum(grams)\nFROM our_beans\nGROUP BY name, color, delicious;\"\"\")\n\nDA.generate_partner_view = _generate_partner_view","commandVersion":1,"state":"finished","results":{"type":"raw","data":"","arguments":{},"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"efaca41f-a962-4d9a-a681-e4b26abc6a86"},{"version":"CommandV1","origId":779539500130265,"guid":"125cb350-e481-4232-ad05-57fef6409d8e","subtype":"command","commandType":"auto","position":9.0,"command":"def _generate_delete_query(username):\n    import re\n    clean_username = re.sub(\"[^a-zA-Z0-9]\", \"_\", username)\n    database = DA.db_name.replace(DA.clean_username, clean_username)\n    \n    print_sql(5, f\"\"\"\nUSE {database};\n\nDELETE FROM beans\n    \"\"\")\n\nDA.generate_delete_query = _generate_delete_query","commandVersion":1,"state":"finished","results":{"type":"raw","data":"","arguments":{},"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"2975ec58-002d-498a-ab72-76268e5e56e7"},{"version":"CommandV1","origId":779539500130266,"guid":"87288cc3-a65c-4f66-97e2-62811f126a48","subtype":"command","commandType":"auto","position":10.0,"command":"DA.cleanup()\nDA.init(create_db=False)\nDA.conclude_setup()\n","commandVersion":1,"state":"finished","results":{"type":"raw","data":"","arguments":{},"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"dcb550f0-98c6-44d1-a3b7-f07d4e6cbd02"}],"dashboards":[],"guid":"bc8b0a45-333b-4b48-a71a-0f4af3ed044b","globalVars":{},"iPythonMetadata":null,"inputWidgets":{},"notebookMetadata":{"pythonIndentUnit":2},"reposExportFormat":"SOURCE"}