{"version":"NotebookV1","origId":779539500130277,"name":"Classroom-Setup-11.1","language":"python","commands":[{"version":"CommandV1","origId":779539500130278,"guid":"03f53dd6-86bd-4485-8bee-24fd638eb2e2","subtype":"command","commandType":"auto","position":2.0,"command":"%run ./_utility-methods $lesson=\"11.1\"","commandVersion":1,"state":"finished","results":{"type":"raw","data":"","arguments":{},"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"38ade69a-0aef-456e-bd24-2a24bfbc7ffe"},{"version":"CommandV1","origId":779539500130279,"guid":"7e757e88-dc41-4d51-a40a-adb5f9b4f7a2","subtype":"command","commandType":"auto","position":3.0,"command":"def print_sql(rows, sql):\n    html = f\"\"\"<textarea style=\"width:100%\" rows=\"{rows}\"> \\n{sql.strip()}</textarea>\"\"\"\n    displayHTML(html)","commandVersion":1,"state":"finished","results":{"type":"raw","data":"","arguments":{},"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"4fd564e2-0ac7-46b6-8e59-9168e7c4f5ea"},{"version":"CommandV1","origId":779539500130280,"guid":"989b7e65-995f-451f-8ba5-4c498886e03a","subtype":"command","commandType":"auto","position":4.0,"command":"def _generate_users_table():\n    print_sql(20, f\"\"\"\nCREATE DATABASE IF NOT EXISTS {DA.db_name}\nLOCATION '{DA.paths.user_db}';\n\nUSE {DA.db_name};\n\nCREATE TABLE users (id INT, name STRING, value DOUBLE, state STRING);\n\nINSERT INTO users\nVALUES (1, \"Yve\", 1.0, \"CA\"),\n       (2, \"Omar\", 2.5, \"NY\"),\n       (3, \"Elia\", 3.3, \"OH\"),\n       (4, \"Rebecca\", 4.7, \"TX\"),\n       (5, \"Ameena\", 5.3, \"CA\"),\n       (6, \"Ling\", 6.6, \"NY\"),\n       (7, \"Pedro\", 7.1, \"KY\");\n\nCREATE VIEW ny_users_vw\nAS SELECT * FROM users WHERE state = 'NY';\n\"\"\")\n    \nDA.generate_users_table = _generate_users_table","commandVersion":1,"state":"finished","results":{"type":"raw","data":"","arguments":{},"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"09f24934-4398-40a7-92f1-d9473117261c"},{"version":"CommandV1","origId":779539500130281,"guid":"66574bec-60bd-4c1e-96f5-217094e37b1c","subtype":"command","commandType":"auto","position":5.0,"command":"def _generate_create_database_with_grants():\n    print_sql(7, f\"\"\"\nCREATE DATABASE {DA.db_name}_derivative;\n\nGRANT USAGE, READ_METADATA, CREATE, MODIFY, SELECT ON DATABASE `{DA.db_name}_derivative` TO `users`;\n\nSHOW GRANT ON DATABASE `{DA.db_name}_derivative`;\"\"\")    \n    \nDA.generate_create_database_with_grants = _generate_create_database_with_grants","commandVersion":1,"state":"finished","results":{"type":"raw","data":"","arguments":{},"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"59e33523-a535-41d9-973b-0eb4e0773980"},{"version":"CommandV1","origId":779539500130282,"guid":"ab2937f7-1454-479c-9047-f898d373dfea","subtype":"command","commandType":"auto","position":6.0,"command":"DA.cleanup()\nDA.init(create_db=False)\nDA.conclude_setup()\n","commandVersion":1,"state":"finished","results":{"type":"raw","data":"","arguments":{},"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"d91f2986-9d33-4d4d-a517-a9c6f1e16026"}],"dashboards":[],"guid":"32a77948-7c18-494c-a42a-2fc350472c07","globalVars":{},"iPythonMetadata":null,"inputWidgets":{},"notebookMetadata":{"pythonIndentUnit":2},"reposExportFormat":"SOURCE"}