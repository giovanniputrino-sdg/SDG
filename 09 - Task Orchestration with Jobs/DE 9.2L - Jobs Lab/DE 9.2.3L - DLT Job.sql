{"version":"NotebookV1","origId":779539500128277,"name":"DE 9.2.3L - DLT Job","language":"sql","commands":[{"version":"CommandV1","origId":779539500128278,"guid":"ae389a15-1a6e-444d-9894-1b7b2dda9321","subtype":"command","commandType":"auto","position":2.0,"command":"CREATE OR REFRESH STREAMING LIVE TABLE recordings_bronze\nAS SELECT current_timestamp() receipt_time, input_file_name() source_file, *\n  FROM cloud_files(\"${source}\", \"json\", map(\"cloudFiles.schemaHints\", \"time DOUBLE\"))","commandVersion":1,"state":"finished","results":{"type":"raw","data":"","arguments":{},"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"4a438f4d-e437-4cba-ab59-74479df956e0"},{"version":"CommandV1","origId":779539500128279,"guid":"483fac14-dd0c-43bd-a6e0-f366493b09c8","subtype":"command","commandType":"auto","position":3.0,"command":"CREATE OR REFRESH STREAMING LIVE TABLE pii\nAS SELECT *\n  FROM cloud_files(\"/mnt/training/healthcare/patient\", \"csv\", map(\"header\", \"true\", \"cloudFiles.inferColumnTypes\", \"true\"))","commandVersion":1,"state":"finished","results":{"type":"raw","data":"","arguments":{},"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"37006f66-d155-49d1-8c06-f524be9ada42"},{"version":"CommandV1","origId":779539500128280,"guid":"d34667af-5271-425c-aaec-edfbf2f72803","subtype":"command","commandType":"auto","position":4.0,"command":"CREATE OR REFRESH STREAMING LIVE TABLE recordings_enriched\n  (CONSTRAINT positive_heartrate EXPECT (heartrate > 0) ON VIOLATION DROP ROW)\nAS SELECT \n  CAST(a.device_id AS INTEGER) device_id, \n  CAST(a.mrn AS LONG) mrn, \n  CAST(a.heartrate AS DOUBLE) heartrate, \n  CAST(from_unixtime(a.time, 'yyyy-MM-dd HH:mm:ss') AS TIMESTAMP) time,\n  b.name\n  FROM STREAM(live.recordings_bronze) a\n  INNER JOIN STREAM(live.pii) b\n  ON a.mrn = b.mrn","commandVersion":1,"state":"finished","results":{"type":"raw","data":"","arguments":{},"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"5d2e2283-aaa9-4381-91fe-bb2879f11244"},{"version":"CommandV1","origId":779539500128281,"guid":"b68ab8cf-abb4-4fa5-8a9c-cdd2cccd21bc","subtype":"command","commandType":"auto","position":5.0,"command":"CREATE OR REFRESH STREAMING LIVE TABLE daily_patient_avg\n  COMMENT \"Daily mean heartrates by patient\"\nAS SELECT mrn, name, MEAN(heartrate) avg_heartrate, DATE(time) `date`\n  FROM STREAM(live.recordings_enriched)\n  GROUP BY mrn, name, DATE(time)\n","commandVersion":1,"state":"finished","results":{"type":"raw","data":"","arguments":{},"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"5953da19-c25c-4f35-bfec-9fd0091ec3cc"}],"dashboards":[],"guid":"057d9a25-969c-4b00-bcc2-cacebde8f1d3","globalVars":{},"iPythonMetadata":null,"inputWidgets":{},"notebookMetadata":{"pythonIndentUnit":2},"reposExportFormat":"SOURCE"}